#!/bin/bash

######################################
#				                             #
#   Author  : Youri Klaassens	       #
#   Alias   : Xhendos 		           #
#   Date    : 12th of August, 2017   #
#				                             #
######################################

# Reads a list of IP adresses and tries if it is vulnerable for the CVE-2017-5638 Exploit.
# Once there is a server vulnerable the following details will be printed {IP Adres, Port}
# Because a webserver can run on either port 80 or port 443, this needs to be specified by the user.
# Usage: ./main.sh [Text file containing IP adresses] [Port]

FILE_NAME=$1
PORT=$2

while read IP
do
	OUTPUT=$(./struts_check.sh $IP $PORT)

	if [ "$OUTPUT" == "True" ];
	then
		echo "[APACHE_STRUTS] $IP:$PORT"
	fi
	

done < $FILE_NAME
